<!DOCTYPE html>
<html>
<head>
    <title>Escalations</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div id="headerBar">
    <div class="header-left">
        <h2>Escalation Matrix</h2>
    </div>

    <div class="header-right">
        <span id="loggedInUser"></span>
        <button id="loginBtn" class="btn secondary" onclick="goToAdminLogin()">Admin Login</button>
        <button id="auditBtn" class="btn secondary" onclick="goToAudit()">Audit Logs</button>
        <button class="btn secondary" onclick="window.location.href='/static/dashboard.html'">Dashboard</button>
        <button id="logoutBtn" class="btn danger" onclick="logout()">Logout</button>
        <button id="createBtn" class="btn primary" onclick="goToCreate()">Create Escalation</button>
    </div>
</div>

<div class="container">
    <div class="card">
        <h3>Escalation Configurations</h3>

        <div class="filter-bar">
            <input type="text" id="searchInput" placeholder="Search by Unit, Geography, Infra App or Application..." onkeyup="applyFilters()">

            <select id="unitFilter" onchange="applyFilters()">
                <option value="">All Units</option>
            </select>

            <select id="geoFilter" onchange="applyFilters()">
                <option value="">All Geographies</option>
            </select>

            <select id="infraFilter" onchange="applyFilters()">
                <option value="">All Infra Apps</option>
            </select>

            <select id="appFilter" onchange="applyFilters()">
                <option value="">All Applications</option>
            </select>

            <button class="btn secondary" onclick="clearFilters()">Clear</button>

            <button id="exportBtn" class="btn primary" onclick="exportCSV()">Export CSV</button>

        </div>

        <table class="modern-table">
            <thead>
                <tr>
                    <th onclick="sortTable('unit')">Unit</th>
                    <th onclick="sortTable('geography')">Geography</th>
                    <th onclick="sortTable('infra_app')">Infra App</th>
                    <th onclick="sortTable('application')">Application</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="tableBody"></tbody>
        </table>

        <div class="pagination-bar">
            <div id="resultInfo"></div>

            <div class="pagination-controls">
                <label>
                    Rows:
                    <select id="rowsPerPage" onchange="changeRowsPerPage()">
                        <option value="5">5</option>
                        <option value="10" selected>10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                    </select>
                </label>

                <button class="btn secondary" onclick="prevPage()">Prev</button>
                <span id="pageNumbers"></span>
                <button class="btn secondary" onclick="nextPage()">Next</button>
            </div>
        </div>

    </div>
</div>

<div id="toastContainer"></div>

<script src="/static/main.js"></script>
<script>
    loadEscalations();
</script>

</body>
</html>